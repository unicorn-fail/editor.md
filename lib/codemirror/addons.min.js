/*! Editor.md v1.5.0 | /Users/markcarver/sandbox/repositories/github/unicorn-fail/editor.md/lib/codemirror/addons.min.js | Open source online markdown editor. | MIT License | By: Pandao | https://github.com/pandao/editor.md | 2018-03-29 */
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineOption("showTrailingSpace",!1,function(t,r,n){n==e.Init&&(n=!1),n&&!r?t.removeOverlay("trailingspace"):!n&&r&&t.addOverlay({token:function(e){for(var t=e.string.length,r=t;r&&/\s/.test(e.string.charAt(r-1));--r);return r>e.pos?(e.pos=r,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,r){var n,i=e.getWrapperElement();return n=i.appendChild(document.createElement("div")),n.className=r?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?n.innerHTML=t:n.appendChild(t),n}function r(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(n,i,o){function a(e){if("string"==typeof e)d.value=e;else{if(c)return;c=!0,l.parentNode.removeChild(l),u.focus(),o.onClose&&o.onClose(l)}}o||(o={}),r(this,null);var s,l=t(this,n,o.bottom),c=!1,u=this,d=l.getElementsByTagName("input")[0];return d?(d.focus(),o.value&&(d.value=o.value,!1!==o.selectValueOnOpen&&d.select()),o.onInput&&e.on(d,"input",function(e){o.onInput(e,d.value,a)}),o.onKeyUp&&e.on(d,"keyup",function(e){o.onKeyUp(e,d.value,a)}),e.on(d,"keydown",function(t){o&&o.onKeyDown&&o.onKeyDown(t,d.value,a)||((27==t.keyCode||!1!==o.closeOnEnter&&13==t.keyCode)&&(d.blur(),e.e_stop(t),a()),13==t.keyCode&&i(d.value,t))}),!1!==o.closeOnBlur&&e.on(d,"blur",a)):(s=l.getElementsByTagName("button")[0])&&(e.on(s,"click",function(){a(),u.focus()}),!1!==o.closeOnBlur&&e.on(s,"blur",a),s.focus()),a}),e.defineExtension("openConfirm",function(n,i,o){function a(){c||(c=!0,s.parentNode.removeChild(s),u.focus())}r(this,null);var s=t(this,n,o&&o.bottom),l=s.getElementsByTagName("button"),c=!1,u=this,d=1;l[0].focus();for(var m=0;m<l.length;++m){var f=l[m];!function(t){e.on(f,"click",function(r){e.e_preventDefault(r),a(),t&&t(u)})}(i[m]),e.on(f,"blur",function(){--d,setTimeout(function(){d<=0&&a()},200)}),e.on(f,"focus",function(){++d})}}),e.defineExtension("openNotification",function(n,i){function o(){l||(l=!0,clearTimeout(a),s.parentNode.removeChild(s))}r(this,o);var a,s=t(this,n,i&&i.bottom),l=!1,c=i&&void 0!==i.duration?i.duration:5e3;return e.on(s,"click",function(t){e.e_preventDefault(t),o()}),c&&(a=setTimeout(o,c)),o})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){var t=e.flags;return null!=t?t:(e.ignoreCase?"i":"")+(e.global?"g":"")+(e.multiline?"m":"")}function r(e,r){for(var n=t(e),i=n,o=0;o<r.length;o++)-1==i.indexOf(r.charAt(o))&&(i+=r.charAt(o));return n==i?e:new RegExp(e.source,i)}function n(e){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(e.source)}function i(e,t,n){t=r(t,"g");for(var i=n.line,o=n.ch,a=e.lastLine();i<=a;i++,o=0){t.lastIndex=o;var s=e.getLine(i),l=t.exec(s);if(l)return{from:h(i,l.index),to:h(i,l.index+l[0].length),match:l}}}function o(e,t,o){if(!n(t))return i(e,t,o);t=r(t,"gm");for(var a,s=1,l=o.line,c=e.lastLine();l<=c;){for(var u=0;u<s&&!(l>c);u++){var d=e.getLine(l++);a=null==a?d:a+"\n"+d}s*=2,t.lastIndex=o.ch;var m=t.exec(a);if(m){var f=a.slice(0,m.index).split("\n"),p=m[0].split("\n"),g=o.line+f.length-1,b=f[f.length-1].length;return{from:h(g,b),to:h(g+p.length-1,1==p.length?b+p[0].length:p[p.length-1].length),match:m}}}}function a(e,t){for(var r,n=0;;){t.lastIndex=n;var i=t.exec(e);if(!i)return r;if(r=i,(n=r.index+(r[0].length||1))==e.length)return r}}function s(e,t,n){t=r(t,"g");for(var i=n.line,o=n.ch,s=e.firstLine();i>=s;i--,o=-1){var l=e.getLine(i);o>-1&&(l=l.slice(0,o));var c=a(l,t);if(c)return{from:h(i,c.index),to:h(i,c.index+c[0].length),match:c}}}function l(e,t,n){t=r(t,"gm");for(var i,o=1,s=n.line,l=e.firstLine();s>=l;){for(var c=0;c<o;c++){var u=e.getLine(s--);i=null==i?u.slice(0,n.ch):u+"\n"+i}o*=2;var d=a(i,t);if(d){var m=i.slice(0,d.index).split("\n"),f=d[0].split("\n"),p=s+m.length,g=m[m.length-1].length;return{from:h(p,g),to:h(p+f.length-1,1==f.length?g+f[0].length:f[f.length-1].length),match:d}}}}function c(e,t,r,n){if(e.length==t.length)return r;for(var i=0,o=r+Math.max(0,e.length-t.length);;){if(i==o)return i;var a=i+o>>1,s=n(e.slice(0,a)).length;if(s==r)return a;s>r?o=a:i=a+1}}function u(e,t,r,n){if(!t.length)return null;var i=n?f:p,o=i(t).split(/\r|\n\r?/);e:for(var a=r.line,s=r.ch,l=e.lastLine()+1-o.length;a<=l;a++,s=0){var u=e.getLine(a).slice(s),d=i(u);if(1==o.length){var m=d.indexOf(o[0]);if(-1==m)continue e;var r=c(u,d,m,i)+s;return{from:h(a,c(u,d,m,i)+s),to:h(a,c(u,d,m+o[0].length,i)+s)}}var g=d.length-o[0].length;if(d.slice(g)==o[0]){for(var b=1;b<o.length-1;b++)if(i(e.getLine(a+b))!=o[b])continue e;var y=e.getLine(a+o.length-1),v=i(y),x=o[o.length-1];if(v.slice(0,x.length)==x)return{from:h(a,c(u,d,g,i)+s),to:h(a+o.length-1,c(y,v,x.length,i))}}}}function d(e,t,r,n){if(!t.length)return null;var i=n?f:p,o=i(t).split(/\r|\n\r?/);e:for(var a=r.line,s=r.ch,l=e.firstLine()-1+o.length;a>=l;a--,s=-1){var u=e.getLine(a);s>-1&&(u=u.slice(0,s));var d=i(u);if(1==o.length){var m=d.lastIndexOf(o[0]);if(-1==m)continue e;return{from:h(a,c(u,d,m,i)),to:h(a,c(u,d,m+o[0].length,i))}}var g=o[o.length-1];if(d.slice(0,g.length)==g){for(var b=1,r=a-o.length+1;b<o.length-1;b++)if(i(e.getLine(r+b))!=o[b])continue e;var y=e.getLine(a+1-o.length),v=i(y);if(v.slice(v.length-o[0].length)==o[0])return{from:h(a+1-o.length,c(y,v,y.length-o[0].length,i)),to:h(a,c(u,d,g.length,i))}}}}function m(e,t,n,a){this.atOccurrence=!1,this.doc=e,n=n?e.clipPos(n):h(0,0),this.pos={from:n,to:n};var c;"object"==typeof a?c=a.caseFold:(c=a,a=null),"string"==typeof t?(null==c&&(c=!1),this.matches=function(r,n){return(r?d:u)(e,t,n,c)}):(t=r(t,"gm"),a&&!1===a.multiline?this.matches=function(r,n){return(r?s:i)(e,t,n)}:this.matches=function(r,n){return(r?l:o)(e,t,n)})}var f,p,h=e.Pos;String.prototype.normalize?(f=function(e){return e.normalize("NFD").toLowerCase()},p=function(e){return e.normalize("NFD")}):(f=function(e){return e.toLowerCase()},p=function(e){return e}),m.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){for(var r=this.matches(t,this.doc.clipPos(t?this.pos.from:this.pos.to));r&&0==e.cmpPos(r.from,r.to);)t?r.from.ch?r.from=h(r.from.line,r.from.ch-1):r=r.from.line==this.doc.firstLine()?null:this.matches(t,this.doc.clipPos(h(r.from.line-1))):r.to.ch<this.doc.getLine(r.to.line).length?r.to=h(r.to.line,r.to.ch+1):r=r.to.line==this.doc.lastLine()?null:this.matches(t,h(r.to.line+1,0));if(r)return this.pos=r,this.atOccurrence=!0,this.pos.match||!0;var n=h(t?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:n,to:n},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(t,r){if(this.atOccurrence){var n=e.splitLines(t);this.doc.replaceRange(n,this.pos.from,this.pos.to,r),this.pos.to=h(this.pos.from.line+n.length-1,n[n.length-1].length+(1==n.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,t,r){return new m(this.doc,e,t,r)}),e.defineDocExtension("getSearchCursor",function(e,t,r){return new m(this,e,t,r)}),e.defineExtension("selectMatches",function(t,r){for(var n=[],i=this.getSearchCursor(t,this.getCursor("from"),r);i.findNext()&&!(e.cmpPos(i.to(),this.getCursor("to"))>0);)n.push({anchor:i.from(),head:i.to()});n.length&&this.setSelections(n,0)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var r=e.exec(t.string);if(r&&r.index==t.pos)return t.pos+=r[0].length||1,"searching";r?t.pos=r.index:t.skipToEnd()}}}function r(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function n(e){return e.state.search||(e.state.search=new r)}function i(e){return"string"==typeof e&&e==e.toLowerCase()}function o(e,t,r){return e.getSearchCursor(t,r,{caseFold:i(t),multiline:!0})}function a(e,t,r,n,i){e.openDialog(t,n,{value:r,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){p(e)},onKeyDown:i})}function s(e,t,r,n,i){e.openDialog?e.openDialog(t,i,{value:n,selectValueOnOpen:!0}):i(prompt(r,n))}function l(e,t,r,n){e.openConfirm?e.openConfirm(t,n):confirm(r)&&n[0]()}function c(e){return e.replace(/\\(.)/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":t})}function u(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(e){}else e=c(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function d(e,r,n){r.queryText=n,r.query=u(n),e.removeOverlay(r.overlay,i(r.query)),r.overlay=t(r.query,i(r.query)),e.addOverlay(r.overlay),e.showMatchesOnScrollbar&&(r.annotate&&(r.annotate.clear(),r.annotate=null),r.annotate=e.showMatchesOnScrollbar(r.query,i(r.query)))}function m(t,r,i,o){var l=n(t);if(l.query)return f(t,r);var c=t.getSelection()||l.lastQuery;if(c instanceof RegExp&&"x^"==c.source&&(c=null),i&&t.openDialog){var u=null,m=function(r,n){e.e_stop(n),r&&(r!=l.queryText&&(d(t,l,r),l.posFrom=l.posTo=t.getCursor()),u&&(u.style.opacity=1),f(t,n.shiftKey,function(e,r){var n;r.line<3&&document.querySelector&&(n=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&n.getBoundingClientRect().bottom-4>t.cursorCoords(r,"window").top&&((u=n).style.opacity=.4)}))};a(t,b,c,m,function(r,i){var o=e.keyName(r),a=t.getOption("extraKeys"),s=a&&a[o]||e.keyMap[t.getOption("keyMap")][o];"findNext"==s||"findPrev"==s||"findPersistentNext"==s||"findPersistentPrev"==s?(e.e_stop(r),d(t,n(t),i),t.execCommand(s)):"find"!=s&&"findPersistent"!=s||(e.e_stop(r),m(i,r))}),o&&c&&(d(t,l,c),f(t,r))}else s(t,b,"Search for:",c,function(e){e&&!l.query&&t.operation(function(){d(t,l,e),l.posFrom=l.posTo=t.getCursor(),f(t,r)})})}function f(t,r,i){t.operation(function(){var a=n(t),s=o(t,a.query,r?a.posFrom:a.posTo);(s.find(r)||(s=o(t,a.query,r?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0)),s.find(r)))&&(t.setSelection(s.from(),s.to()),t.scrollIntoView({from:s.from(),to:s.to()},20),a.posFrom=s.from(),a.posTo=s.to(),i&&i(s.from(),s.to()))})}function p(e){e.operation(function(){var t=n(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function h(e,t,r){e.operation(function(){for(var n=o(e,t);n.findNext();)if("string"!=typeof t){var i=e.getRange(n.from(),n.to()).match(t);n.replace(r.replace(/\$(\d)/g,function(e,t){return i[t]}))}else n.replace(r)})}function g(e,t){if(!e.getOption("readOnly")){var r=e.getSelection()||n(e).lastQuery,i='<span class="CodeMirror-search-label">'+(t?"Replace all:":"Replace:")+"</span>";s(e,i+y,i,r,function(r){r&&(r=u(r),s(e,v,"Replace with:","",function(n){if(n=c(n),t)h(e,r,n);else{p(e);var i=o(e,r,e.getCursor("from")),a=function(){var t,c=i.from();!(t=i.findNext())&&(i=o(e,r),!(t=i.findNext())||c&&i.from().line==c.line&&i.from().ch==c.ch)||(e.setSelection(i.from(),i.to()),e.scrollIntoView({from:i.from(),to:i.to()}),l(e,x,"Replace?",[function(){s(t)},a,function(){h(e,r,n)}]))},s=function(e){i.replace("string"==typeof r?n:n.replace(/\$(\d)/g,function(t,r){return e[r]})),a()};a()}}))})}}var b='<span class="CodeMirror-search-label">Search:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',y=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',v='<span class="CodeMirror-search-label">With:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',x='<span class="CodeMirror-search-label">Replace?</span> <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>';e.commands.find=function(e){p(e),m(e)},e.commands.findPersistent=function(e){p(e),m(e,!1,!0)},e.commands.findPersistentNext=function(e){m(e,!1,!0,!0)},e.commands.findPersistentPrev=function(e){m(e,!0,!0,!0)},e.commands.findNext=m,e.commands.findPrev=function(e){m(e,!0)},e.commands.clearSearch=p,e.commands.replace=g,e.commands.replaceAll=function(e){g(e,!0)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){function r(e){clearTimeout(n.doRedraw),n.doRedraw=setTimeout(function(){n.redraw()},e)}this.cm=e,this.options=t,this.buttonHeight=t.scrollButtonHeight||e.getOption("scrollButtonHeight"),this.annotations=[],this.doRedraw=this.doUpdate=null,this.div=e.getWrapperElement().appendChild(document.createElement("div")),this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none",this.computeScale();var n=this;e.on("refresh",this.resizeHandler=function(){clearTimeout(n.doUpdate),n.doUpdate=setTimeout(function(){n.computeScale()&&r(20)},100)}),e.on("markerAdded",this.resizeHandler),e.on("markerCleared",this.resizeHandler),!1!==t.listenForChanges&&e.on("change",this.changeHandler=function(){r(250)})}e.defineExtension("annotateScrollbar",function(e){return"string"==typeof e&&(e={className:e}),new t(this,e)}),e.defineOption("scrollButtonHeight",0),t.prototype.computeScale=function(){var e=this.cm,t=(e.getWrapperElement().clientHeight-e.display.barHeight-2*this.buttonHeight)/e.getScrollerElement().scrollHeight;if(t!=this.hScale)return this.hScale=t,!0},t.prototype.update=function(e){this.annotations=e,this.redraw()},t.prototype.redraw=function(e){function t(e,t){return l!=e.line&&(l=e.line,c=r.getLineHandle(l)),c.widgets&&c.widgets.length||a&&c.height>s?r.charCoords(e,"local")[t?"top":"bottom"]:r.heightAtLine(c,"local")+(t?0:c.height)}!1!==e&&this.computeScale();var r=this.cm,n=this.hScale,i=document.createDocumentFragment(),o=this.annotations,a=r.getOption("lineWrapping"),s=a&&1.5*r.defaultTextHeight(),l=null,c=null,u=r.lastLine();if(r.display.barWidth)for(var d,m=0;m<o.length;m++){var f=o[m];if(!(f.to.line>u)){for(var p=d||t(f.from,!0)*n,h=t(f.to,!1)*n;m<o.length-1&&!(o[m+1].to.line>u)&&!((d=t(o[m+1].from,!0)*n)>h+.9);)f=o[++m],h=t(f.to,!1)*n;if(h!=p){var g=Math.max(h-p,3),b=i.appendChild(document.createElement("div"));b.style.cssText="position: absolute; right: 0px; width: "+Math.max(r.display.barWidth-1,2)+"px; top: "+(p+this.buttonHeight)+"px; height: "+g+"px",b.className=this.options.className,f.id&&b.setAttribute("annotation-id",f.id)}}}this.div.textContent="",this.div.appendChild(i)},t.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler),this.cm.off("markerAdded",this.resizeHandler),this.cm.off("markerCleared",this.resizeHandler),this.changeHandler&&this.cm.off("change",this.changeHandler),this.div.parentNode.removeChild(this.div)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,r,n){this.cm=e,this.options=n;var i={listenForChanges:!1};for(var o in n)i[o]=n[o];i.className||(i.className="CodeMirror-search-match"),this.annotation=e.annotateScrollbar(i),this.query=t,this.caseFold=r,this.gap={from:e.firstLine(),to:e.lastLine()+1},this.matches=[],this.update=null,this.findMatches(),this.annotation.update(this.matches);var a=this;e.on("change",this.changeHandler=function(e,t){a.onChange(t)})}function r(e,t,r){return e<=t?e:Math.max(t,e+r)}e.defineExtension("showMatchesOnScrollbar",function(e,r,n){return"string"==typeof n&&(n={className:n}),n||(n={}),new t(this,e,r,n)});var n=1e3;t.prototype.findMatches=function(){if(this.gap){for(var t=0;t<this.matches.length;t++){var r=this.matches[t];if(r.from.line>=this.gap.to)break;r.to.line>=this.gap.from&&this.matches.splice(t--,1)}for(var i=this.cm.getSearchCursor(this.query,e.Pos(this.gap.from,0),this.caseFold),o=this.options&&this.options.maxMatches||n;i.findNext();){var r={from:i.from(),to:i.to()};if(r.from.line>=this.gap.to)break;if(this.matches.splice(t++,0,r),this.matches.length>o)break}this.gap=null}},t.prototype.onChange=function(t){var n=t.from.line,i=e.changeEnd(t).line,o=i-t.to.line;if(this.gap?(this.gap.from=Math.min(r(this.gap.from,n,o),t.from.line),this.gap.to=Math.max(r(this.gap.to,n,o),t.from.line)):this.gap={from:t.from.line,to:i+1},o)for(var a=0;a<this.matches.length;a++){var s=this.matches[a],l=r(s.from.line,n,o);l!=s.from.line&&(s.from=e.Pos(l,s.from.ch));var c=r(s.to.line,n,o);c!=s.to.line&&(s.to=e.Pos(c,s.to.ch))}clearTimeout(this.update);var u=this;this.update=setTimeout(function(){u.updateAfterChange()},250)},t.prototype.updateAfterChange=function(){this.findMatches(),this.annotation.update(this.matches)},t.prototype.clear=function(){this.cm.off("change",this.changeHandler),this.annotation.clear()}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function r(e){t(e);var r=e.state.placeholder=document.createElement("pre");r.style.cssText="height: 0; overflow: visible",r.style.direction=e.getOption("direction"),r.className="CodeMirror-placeholder";var n=e.getOption("placeholder");"string"==typeof n&&(n=document.createTextNode(n)),r.appendChild(n),e.display.lineSpace.insertBefore(r,e.display.lineSpace.firstChild)}function n(e){o(e)&&r(e)}function i(e){var n=e.getWrapperElement(),i=o(e);n.className=n.className.replace(" CodeMirror-empty","")+(i?" CodeMirror-empty":""),i?r(e):t(e)}function o(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",function(r,o,a){var s=a&&a!=e.Init;if(o&&!s)r.on("blur",n),r.on("change",i),r.on("swapDoc",i),i(r);else if(!o&&s){r.off("blur",n),r.off("change",i),r.off("swapDoc",i),t(r);var l=r.getWrapperElement();l.className=l.className.replace(" CodeMirror-empty","")}o&&!r.hasFocus()&&n(r)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function t(t){if(t.getOption("disableInput"))return e.Pass;for(var r=t.listSelections(),n=[],l=t.getOption("autoCloseTags"),c=0;c<r.length;c++){if(!r[c].empty())return e.Pass;var u=r[c].head,d=t.getTokenAt(u),m=e.innerMode(t.getMode(),d.state),f=m.state;if("xml"!=m.mode.name||!f.tagName)return e.Pass;var p="html"==m.mode.configuration,h="object"==typeof l&&l.dontCloseTags||p&&a,g="object"==typeof l&&l.indentTags||p&&s,b=f.tagName;d.end>u.ch&&(b=b.slice(0,b.length-d.end+u.ch));var y=b.toLowerCase();if(!b||"string"==d.type&&(d.end!=u.ch||!/[\"\']/.test(d.string.charAt(d.string.length-1))||1==d.string.length)||"tag"==d.type&&"closeTag"==f.type||d.string.indexOf("/")==d.string.length-1||h&&i(h,y)>-1||o(t,b,u,f,!0))return e.Pass;var v=g&&i(g,y)>-1;n[c]={indent:v,text:">"+(v?"\n\n":"")+"</"+b+">",newPos:v?e.Pos(u.line+1,0):e.Pos(u.line,u.ch+1)}}for(var x="object"==typeof l&&l.dontIndentOnAutoClose,c=r.length-1;c>=0;c--){var _=n[c];t.replaceRange(_.text,r[c].head,r[c].anchor,"+insert");var k=t.listSelections().slice(0);k[c]={head:_.newPos,anchor:_.newPos},t.setSelections(k),!x&&_.indent&&(t.indentLine(_.newPos.line,null,!0),t.indentLine(_.newPos.line+1,null,!0))}}function r(t,r){for(var n=t.listSelections(),i=[],a=r?"/":"</",s=t.getOption("autoCloseTags"),l="object"==typeof s&&s.dontIndentOnSlash,c=0;c<n.length;c++){if(!n[c].empty())return e.Pass;var u=n[c].head,d=t.getTokenAt(u),m=e.innerMode(t.getMode(),d.state),f=m.state;if(r&&("string"==d.type||"<"!=d.string.charAt(0)||d.start!=u.ch-1))return e.Pass;var p;if("xml"!=m.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==m.mode.name)p=a+"script";else{if("htmlmixed"!=t.getMode().name||"css"!=m.mode.name)return e.Pass;p=a+"style"}else{if(!f.context||!f.context.tagName||o(t,f.context.tagName,u,f))return e.Pass;p=a+f.context.tagName}">"!=t.getLine(u.line).charAt(d.end)&&(p+=">"),i[c]=p}if(t.replaceSelections(i),n=t.listSelections(),!l)for(var c=0;c<n.length;c++)(c==n.length-1||n[c].head.line<n[c+1].head.line)&&t.indentLine(n[c].head.line)}function n(t){return t.getOption("disableInput")?e.Pass:r(t,!0)}function i(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;++r)if(e[r]==t)return r;return-1}function o(t,r,n,i,o){if(!e.scanForClosingTag)return!1;var a=Math.min(t.lastLine()+1,n.line+500),s=e.scanForClosingTag(t,n,null,a);if(!s||s.tag!=r)return!1;for(var l=i.context,c=o?1:0;l&&l.tagName==r;l=l.prev)++c;n=s.to;for(var u=1;u<c;u++){var d=e.scanForClosingTag(t,n,null,a);if(!d||d.tag!=r)return!1;n=d.to}return!0}e.defineOption("autoCloseTags",!1,function(r,i,o){if(o!=e.Init&&o&&r.removeKeyMap("autoCloseTags"),i){var a={name:"autoCloseTags"};("object"!=typeof i||i.whenClosing)&&(a["'/'"]=function(e){return n(e)}),("object"!=typeof i||i.whenOpening)&&(a["'>'"]=function(e){return t(e)}),r.addKeyMap(a)}});var a=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],s=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];e.commands.closeTag=function(e){return r(e)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,i,o,a){function s(e){var r=l(t,i);if(!r||r.to.line-r.from.line<c)return null;for(var n=t.findMarksAt(r.from),o=0;o<n.length;++o)if(n[o].__isFold&&"fold"!==a){if(!e)return null;r.cleared=!0,n[o].clear()}return r}if(o&&o.call){var l=o;o=null}else var l=n(t,o,"rangeFinder");"number"==typeof i&&(i=e.Pos(i,0));var c=n(t,o,"minFoldSize"),u=s(!0);if(n(t,o,"scanUp"))for(;!u&&i.line>t.firstLine();)i=e.Pos(i.line-1,0),u=s(!1);if(u&&!u.cleared&&"unfold"!==a){var d=r(t,o);e.on(d,"mousedown",function(t){m.clear(),e.e_preventDefault(t)});var m=t.markText(u.from,u.to,{replacedWith:d,clearOnEnter:n(t,o,"clearOnEnter"),__isFold:!0});m.on("clear",function(r,n){e.signal(t,"unfold",t,r,n)}),e.signal(t,"fold",t,u.from,u.to)}}function r(e,t){var r=n(e,t,"widget");if("string"==typeof r){var i=document.createTextNode(r);r=document.createElement("span"),r.appendChild(i),r.className="CodeMirror-foldmarker"}else r&&(r=r.cloneNode(!0));return r}function n(e,t,r){if(t&&void 0!==t[r])return t[r];var n=e.options.foldOptions;return n&&void 0!==n[r]?n[r]:i[r]}e.newFoldFunction=function(e,r){return function(n,i){t(n,i,{rangeFinder:e,widget:r})}},e.defineExtension("foldCode",function(e,r,n){t(this,e,r,n)}),e.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),r=0;r<t.length;++r)if(t[r].__isFold)return!0}),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation(function(){for(var r=t.firstLine(),n=t.lastLine();r<=n;r++)t.foldCode(e.Pos(r,0),null,"fold")})},e.commands.unfoldAll=function(t){t.operation(function(){for(var r=t.firstLine(),n=t.lastLine();r<=n;r++)t.foldCode(e.Pos(r,0),null,"unfold")})},e.registerHelper("fold","combine",function(){var e=Array.prototype.slice.call(arguments,0);return function(t,r){for(var n=0;n<e.length;++n){var i=e[n](t,r);if(i)return i}}}),e.registerHelper("fold","auto",function(e,t){for(var r=e.getHelpers(t,"fold"),n=0;n<r.length;n++){var i=r[n](e,t);if(i)return i}});var i={rangeFinder:e.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1,clearOnEnter:!0};e.defineOption("foldOptions",null),e.defineExtension("foldOption",function(e,t){return n(this,e,t)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options=e,this.from=this.to=0}function r(e){return!0===e&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function n(e,t){for(var r=e.findMarks(d(t,0),d(t+1,0)),n=0;n<r.length;++n)if(r[n].__isFold&&r[n].find().from.line==t)return r[n]}function i(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function o(e,t,r){var o=e.state.foldGutter.options,a=t,s=e.foldOption(o,"minFoldSize"),l=e.foldOption(o,"rangeFinder");e.eachLine(t,r,function(t){var r=null;if(n(e,a))r=i(o.indicatorFolded);else{var c=d(a,0),u=l&&l(e,c);u&&u.to.line-u.from.line>=s&&(r=i(o.indicatorOpen))}e.setGutterMarker(t,o.gutter,r),++a})}function a(e){var t=e.getViewport(),r=e.state.foldGutter;r&&(e.operation(function(){o(e,t.from,t.to)}),r.from=t.from,r.to=t.to)}function s(e,t,r){var i=e.state.foldGutter;if(i){var o=i.options;if(r==o.gutter){var a=n(e,t);a?a.clear():e.foldCode(d(t,0),o.rangeFinder)}}}function l(e){var t=e.state.foldGutter;if(t){var r=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){a(e)},r.foldOnChangeTimeSpan||600)}}function c(e){var t=e.state.foldGutter;if(t){var r=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){var r=e.getViewport();t.from==t.to||r.from-t.to>20||t.from-r.to>20?a(e):e.operation(function(){r.from<t.from&&(o(e,r.from,t.from),t.from=r.from),r.to>t.to&&(o(e,t.to,r.to),t.to=r.to)})},r.updateViewportTimeSpan||400)}}function u(e,t){var r=e.state.foldGutter;if(r){var n=t.line;n>=r.from&&n<r.to&&o(e,n,n+1)}}e.defineOption("foldGutter",!1,function(n,i,o){o&&o!=e.Init&&(n.clearGutter(n.state.foldGutter.options.gutter),n.state.foldGutter=null,n.off("gutterClick",s),n.off("change",l),n.off("viewportChange",c),n.off("fold",u),n.off("unfold",u),n.off("swapDoc",l)),i&&(n.state.foldGutter=new t(r(i)),a(n),n.on("gutterClick",s),n.on("change",l),n.on("viewportChange",c),n.on("fold",u),n.on("unfold",u),n.on("swapDoc",l))});var d=e.Pos}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,r){var n=t.getLine(r),i=n.search(/\S/);return-1==i||/\bcomment\b/.test(t.getTokenTypeAt(e.Pos(r,i+1)))?-1:e.countColumn(n,null,t.getOption("tabSize"))}e.registerHelper("fold","indent",function(r,n){var i=t(r,n.line);if(!(i<0)){for(var o=null,a=n.line+1,s=r.lastLine();a<=s;++a){var l=t(r,a);if(-1==l);else{if(!(l>i))break;o=a}}return o?{from:e.Pos(n.line,r.getLine(n.line).length),to:e.Pos(o,r.getLine(o).length)}:void 0}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","brace",function(t,r){function n(n){for(var s=r.ch,l=0;;){var c=s<=0?-1:a.lastIndexOf(n,s-1);if(-1!=c){if(1==l&&c<r.ch)break;if(i=t.getTokenTypeAt(e.Pos(o,c+1)),!/^(comment|string)/.test(i))return c+1;s=c-1}else{if(1==l)break;l=1,s=a.length}}}var i,o=r.line,a=t.getLine(o),s="{",l="}",c=n("{");if(null==c&&(s="[",l="]",c=n("[")),null!=c){var u,d,m=1,f=t.lastLine();e:for(var p=o;p<=f;++p)for(var h=t.getLine(p),g=p==o?c:0;;){var b=h.indexOf(s,g),y=h.indexOf(l,g);if(b<0&&(b=h.length),y<0&&(y=h.length),(g=Math.min(b,y))==h.length)break;if(t.getTokenTypeAt(e.Pos(p,g+1))==i)if(g==b)++m;else if(!--m){u=p,d=g;break e}++g}if(null!=u&&(o!=u||d!=c))return{from:e.Pos(o,c),to:e.Pos(u,d)}}}),e.registerHelper("fold","import",function(t,r){function n(r){if(r<t.firstLine()||r>t.lastLine())return null;var n=t.getTokenAt(e.Pos(r,1));if(/\S/.test(n.string)||(n=t.getTokenAt(e.Pos(r,n.end+1))),"keyword"!=n.type||"import"!=n.string)return null;for(var i=r,o=Math.min(t.lastLine(),r+10);i<=o;++i){var a=t.getLine(i),s=a.indexOf(";");if(-1!=s)return{startCh:n.end,end:e.Pos(i,s)}}}var i,o=r.line,a=n(o);if(!a||n(o-1)||(i=n(o-2))&&i.end.line==o-1)return null;for(var s=a.end;;){var l=n(s.line+1);if(null==l)break;s=l.end}return{from:t.clipPos(e.Pos(o,a.startCh+1)),to:s}}),e.registerHelper("fold","include",function(t,r){function n(r){if(r<t.firstLine()||r>t.lastLine())return null;var n=t.getTokenAt(e.Pos(r,1));return/\S/.test(n.string)||(n=t.getTokenAt(e.Pos(r,n.end+1))),"meta"==n.type&&"#include"==n.string.slice(0,8)?n.start+8:void 0}var i=r.line,o=n(i);if(null==o||null!=n(i-1))return null;for(var a=i;;){if(null==n(a+1))break;++a}return{from:e.Pos(i,o+1),to:t.clipPos(e.Pos(a))}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line-t.line||e.ch-t.ch}function r(e,t,r,n){this.line=t,this.ch=r,this.cm=e,this.text=e.getLine(t),this.min=n?Math.max(n.from,e.firstLine()):e.firstLine(),this.max=n?Math.min(n.to-1,e.lastLine()):e.lastLine()}function n(e,t){var r=e.cm.getTokenTypeAt(m(e.line,t));return r&&/\btag\b/.test(r)}function i(e){if(!(e.line>=e.max))return e.ch=0,e.text=e.cm.getLine(++e.line),!0}function o(e){if(!(e.line<=e.min))return e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0}function a(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(i(e))continue;return}{if(n(e,t+1)){var r=e.text.lastIndexOf("/",t),o=r>-1&&!/\S/.test(e.text.slice(r+1,t));return e.ch=t+1,o?"selfClose":"regular"}e.ch=t+1}}}function s(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(o(e))continue;return}if(n(e,t+1)){h.lastIndex=t,e.ch=t;var r=h.exec(e.text);if(r&&r.index==t)return r}else e.ch=t}}function l(e){for(;;){h.lastIndex=e.ch;var t=h.exec(e.text);if(!t){if(i(e))continue;return}{if(n(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function c(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(o(e))continue;return}{if(n(e,t+1)){var r=e.text.lastIndexOf("/",t),i=r>-1&&!/\S/.test(e.text.slice(r+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t}}}function u(e,t){for(var r=[];;){var n,i=l(e),o=e.line,s=e.ch-(i?i[0].length:0);if(!i||!(n=a(e)))return;if("selfClose"!=n)if(i[1]){for(var c=r.length-1;c>=0;--c)if(r[c]==i[2]){r.length=c;break}if(c<0&&(!t||t==i[2]))return{tag:i[2],from:m(o,s),to:m(e.line,e.ch)}}else r.push(i[2])}}function d(e,t){for(var r=[];;){var n=c(e);if(!n)return;if("selfClose"!=n){var i=e.line,o=e.ch,a=s(e);if(!a)return;if(a[1])r.push(a[2]);else{for(var l=r.length-1;l>=0;--l)if(r[l]==a[2]){r.length=l;break}if(l<0&&(!t||t==a[2]))return{tag:a[2],from:m(e.line,e.ch),to:m(i,o)}}}else s(e)}}var m=e.Pos,f="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",p=f+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",h=new RegExp("<(/?)(["+f+"]["+p+"]*)","g");e.registerHelper("fold","xml",function(e,t){for(var n=new r(e,t.line,0);;){var i,o=l(n);if(!o||!(i=a(n))||n.line!=t.line)return;if(!o[1]&&"selfClose"!=i){var s=m(n.line,n.ch),c=u(n,o[2]);return c&&{from:s,to:c.from}}}}),e.findMatchingTag=function(e,n,i){var o=new r(e,n.line,n.ch,i);if(-1!=o.text.indexOf(">")||-1!=o.text.indexOf("<")){var l=a(o),c=l&&m(o.line,o.ch),f=l&&s(o);if(l&&f&&!(t(o,n)>0)){var p={from:m(o.line,o.ch),to:c,tag:f[2]};return"selfClose"==l?{open:p,close:null,at:"open"}:f[1]?{open:d(o,f[2]),close:p,at:"close"}:(o=new r(e,c.line,c.ch,i),{open:p,close:u(o,f[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,n,i){for(var o=new r(e,t.line,t.ch,n);;){var a=d(o,i);if(!a)break;var s=new r(e,t.line,t.ch,n),l=u(s,a.tag);if(l)return{open:a,close:l}}},e.scanForClosingTag=function(e,t,n,i){return u(new r(e,t.line,t.ch,i?{from:0,to:i}:null),n)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","markdown",function(t,r){function n(r){var n=t.getTokenTypeAt(e.Pos(r,0));return n&&/\bheader\b/.test(n)}function i(e,t,r){var i=t&&t.match(/^#+/);return i&&n(e)?i[0].length:(i=r&&r.match(/^[=\-]+\s*$/),i&&n(e+1)?"="==r[0]?1:2:o)}var o=100,a=t.getLine(r.line),s=t.getLine(r.line+1),l=i(r.line,a,s);if(l!==o){for(var c=t.lastLine(),u=r.line,d=t.getLine(u+2);u<c&&!(i(u+1,s,d)<=l);)++u,s=d,d=t.getLine(u+2);return{from:e.Pos(r.line,a.length),to:e.Pos(u,t.getLine(u).length)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,r){var n=t.getModeAt(r),i=n.blockCommentStart,o=n.blockCommentEnd;if(i&&o){for(var a,s=r.line,l=t.getLine(s),c=r.ch,u=0;;){var d=c<=0?-1:l.lastIndexOf(i,c-1);if(-1!=d){if(1==u&&d<r.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(s,d+1)))&&(0==d||l.slice(d-o.length,d)==o||!/comment/.test(t.getTokenTypeAt(e.Pos(s,d))))){a=d+i.length;break}c=d-1}else{if(1==u)return;u=1,c=l.length}}var m,f,p=1,h=t.lastLine();e:for(var g=s;g<=h;++g)for(var b=t.getLine(g),y=g==s?a:0;;){var v=b.indexOf(i,y),x=b.indexOf(o,y);if(v<0&&(v=b.length),x<0&&(x=b.length),(y=Math.min(v,x))==b.length)break;if(y==v)++p;else if(!--p){m=g,f=y;break e}++y}if(null!=m&&(s!=m||f!=a))return{from:e.Pos(s,a),to:e.Pos(m,f)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.overlayMode=function(t,r,n){return{startState:function(){return{base:e.startState(t),overlay:e.startState(r),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(n){return{base:e.copyState(t,n.base),overlay:e.copyState(r,n.overlay),basePos:n.basePos,baseCur:null,overlayPos:n.overlayPos,overlayCur:null}},token:function(e,i){return(e!=i.streamSeen||Math.min(i.basePos,i.overlayPos)<e.start)&&(i.streamSeen=e,i.basePos=i.overlayPos=e.start),e.start==i.basePos&&(i.baseCur=t.token(e,i.base),i.basePos=e.pos),e.start==i.overlayPos&&(e.pos=e.start,i.overlayCur=r.token(e,i.overlay),i.overlayPos=e.pos),e.pos=Math.min(i.basePos,i.overlayPos),null==i.overlayCur?i.baseCur:null!=i.baseCur&&i.overlay.combineTokens||n&&null==i.overlay.combineTokens?i.baseCur+" "+i.overlayCur:i.overlayCur},indent:t.indent&&function(e,r){return t.indent(e.base,r)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){var i,o;return t.blankLine&&(i=t.blankLine(e.base)),r.blankLine&&(o=r.blankLine(e.overlay)),null==o?i:n&&null!=i?i+" "+o:o}}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){for(var t=0;t<e.state.activeLines.length;t++)e.removeLineClass(e.state.activeLines[t],"wrap",o),e.removeLineClass(e.state.activeLines[t],"background",a),e.removeLineClass(e.state.activeLines[t],"gutter",s)}function r(e,t){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function n(e,n){for(var i=[],l=0;l<n.length;l++){var c=n[l],u=e.getOption("styleActiveLine");if("object"==typeof u&&u.nonEmpty?c.anchor.line==c.head.line:c.empty()){var d=e.getLineHandleVisualStart(c.head.line);i[i.length-1]!=d&&i.push(d)}}r(e.state.activeLines,i)||e.operation(function(){t(e);for(var r=0;r<i.length;r++)e.addLineClass(i[r],"wrap",o),e.addLineClass(i[r],"background",a),e.addLineClass(i[r],"gutter",s);e.state.activeLines=i})}function i(e,t){n(e,t.ranges)}var o="CodeMirror-activeline",a="CodeMirror-activeline-background",s="CodeMirror-activeline-gutter";e.defineOption("styleActiveLine",!1,function(r,o,a){var s=a!=e.Init&&a;o!=s&&(s&&(r.off("beforeSelectionChange",i),t(r),delete r.state.activeLines),o&&(r.state.activeLines=[],n(r,r.listSelections()),r.on("beforeSelectionChange",i)))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t){return"pairs"==t&&"string"==typeof e?e:"object"==typeof e&&null!=e[t]?e[t]:m[t]}function r(e){for(var t=0;t<e.length;t++){var r=e.charAt(t),i="'"+r+"'";p[i]||(p[i]=n(r))}}function n(e){return function(t){return l(t,e)}}function i(e){var t=e.state.closeBrackets;return!t||t.override?t:e.getModeAt(e.getCursor()).closeBrackets||t}function o(r){var n=i(r);if(!n||r.getOption("disableInput"))return e.Pass;for(var o=t(n,"pairs"),a=r.listSelections(),s=0;s<a.length;s++){if(!a[s].empty())return e.Pass;var l=u(r,a[s].head);if(!l||o.indexOf(l)%2!=0)return e.Pass}for(var s=a.length-1;s>=0;s--){var c=a[s].head;r.replaceRange("",f(c.line,c.ch-1),f(c.line,c.ch+1),"+delete")}}function a(r){var n=i(r),o=n&&t(n,"explode");if(!o||r.getOption("disableInput"))return e.Pass;for(var a=r.listSelections(),s=0;s<a.length;s++){if(!a[s].empty())return e.Pass;var l=u(r,a[s].head);if(!l||o.indexOf(l)%2!=0)return e.Pass}r.operation(function(){var e=r.lineSeparator()||"\n";r.replaceSelection(e+e,null),r.execCommand("goCharLeft"),a=r.listSelections();for(var t=0;t<a.length;t++){var n=a[t].head.line;r.indentLine(n,null,!0),r.indentLine(n+1,null,!0)}})}function s(t){var r=e.cmpPos(t.anchor,t.head)>0;return{anchor:new f(t.anchor.line,t.anchor.ch+(r?-1:1)),head:new f(t.head.line,t.head.ch+(r?1:-1))}}function l(r,n){var o=i(r);if(!o||r.getOption("disableInput"))return e.Pass;var a=t(o,"pairs"),l=a.indexOf(n);if(-1==l)return e.Pass;for(var u,m=t(o,"triples"),p=a.charAt(l+1)==n,h=r.listSelections(),g=l%2==0,b=0;b<h.length;b++){var y,v=h[b],x=v.head,_=r.getRange(x,f(x.line,x.ch+1));if(g&&!v.empty())y="surround";else if(!p&&g||_!=n)if(p&&x.ch>1&&m.indexOf(n)>=0&&r.getRange(f(x.line,x.ch-2),x)==n+n){if(x.ch>2&&/\bstring/.test(r.getTokenTypeAt(f(x.line,x.ch-2))))return e.Pass;y="addFour"}else if(p){var k=0==x.ch?" ":r.getRange(f(x.line,x.ch-1),x);if(e.isWordChar(_)||k==n||e.isWordChar(k))return e.Pass;y="both"}else{if(!g||r.getLine(x.line).length!=x.ch&&!c(_,a)&&!/\s/.test(_))return e.Pass;y="both"}else y=p&&d(r,x)?"both":m.indexOf(n)>=0&&r.getRange(x,f(x.line,x.ch+3))==n+n+n?"skipThree":"skip";if(u){if(u!=y)return e.Pass}else u=y}var w=l%2?a.charAt(l-1):n,S=l%2?n:a.charAt(l+1);r.operation(function(){if("skip"==u)r.execCommand("goCharRight");else if("skipThree"==u)for(var e=0;e<3;e++)r.execCommand("goCharRight");else if("surround"==u){for(var t=r.getSelections(),e=0;e<t.length;e++)t[e]=w+t[e]+S;r.replaceSelections(t,"around"),t=r.listSelections().slice();for(var e=0;e<t.length;e++)t[e]=s(t[e]);r.setSelections(t)}else"both"==u?(r.replaceSelection(w+S,null),r.triggerElectric(w+S),r.execCommand("goCharLeft")):"addFour"==u&&(r.replaceSelection(w+w+w+w,"before"),r.execCommand("goCharRight"))})}function c(e,t){var r=t.lastIndexOf(e);return r>-1&&r%2==1}function u(e,t){var r=e.getRange(f(t.line,t.ch-1),f(t.line,t.ch+1));return 2==r.length?r:null}function d(e,t){var r=e.getTokenAt(f(t.line,t.ch+1));return/\bstring/.test(r.type)&&r.start==t.ch&&(0==t.ch||!/\bstring/.test(e.getTokenTypeAt(t)))}var m={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},f=e.Pos;e.defineOption("autoCloseBrackets",!1,function(n,i,o){o&&o!=e.Init&&(n.removeKeyMap(p),n.state.closeBrackets=null),i&&(r(t(i,"pairs")),n.state.closeBrackets=i,n.addKeyMap(p))});var p={Backspace:o,Enter:a};r(m.pairs+"`")}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}function r(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var r=e.state.fullScreenRestore;t.style.width=r.width,t.style.height=r.height,window.scrollTo(r.scrollLeft,r.scrollTop),e.refresh()}e.defineOption("fullScreen",!1,function(n,i,o){o==e.Init&&(o=!1),!o!=!i&&(i?t(n):r(n))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./matchesonscrollbar"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options={};for(var t in d)this.options[t]=(e&&e.hasOwnProperty(t)?e:d)[t];this.overlay=this.timeout=null,this.matchesonscroll=null,this.active=!1}function r(e){var t=e.state.matchHighlighter;(t.active||e.hasFocus())&&i(e,t)}function n(e){var t=e.state.matchHighlighter;t.active||(t.active=!0,i(e,t))}function i(e,t){clearTimeout(t.timeout),t.timeout=setTimeout(function(){s(e)},t.options.delay)}function o(e,t,r,n){var i=e.state.matchHighlighter;if(e.addOverlay(i.overlay=u(t,r,n)),i.options.annotateScrollbar&&e.showMatchesOnScrollbar){var o=r?new RegExp("\\b"+t.replace(/[\\\[.+*?(){|^$]/g,"\\$&")+"\\b"):t;i.matchesonscroll=e.showMatchesOnScrollbar(o,!1,{className:"CodeMirror-selection-highlight-scrollbar"})}}function a(e){var t=e.state.matchHighlighter;t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null,t.matchesonscroll&&(t.matchesonscroll.clear(),t.matchesonscroll=null))}function s(e){e.operation(function(){var t=e.state.matchHighlighter;if(a(e),!e.somethingSelected()&&t.options.showToken){for(var r=!0===t.options.showToken?/[\w$]/:t.options.showToken,n=e.getCursor(),i=e.getLine(n.line),s=n.ch,c=s;s&&r.test(i.charAt(s-1));)--s;for(;c<i.length&&r.test(i.charAt(c));)++c;return void(s<c&&o(e,i.slice(s,c),r,t.options.style))}var u=e.getCursor("from"),d=e.getCursor("to");if(u.line==d.line&&(!t.options.wordsOnly||l(e,u,d))){var m=e.getRange(u,d);t.options.trim&&(m=m.replace(/^\s+|\s+$/g,"")),m.length>=t.options.minChars&&o(e,m,!1,t.options.style)}})}function l(e,t,r){if(null!==e.getRange(t,r).match(/^\w+$/)){if(t.ch>0){var n={line:t.line,ch:t.ch-1},i=e.getRange(n,t);if(null===i.match(/\W/))return!1}if(r.ch<e.getLine(t.line).length){var n={line:r.line,ch:r.ch+1},i=e.getRange(r,n);if(null===i.match(/\W/))return!1}return!0}return!1}function c(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}function u(e,t,r){return{token:function(n){if(n.match(e)&&(!t||c(n,t)))return r;n.next(),n.skipTo(e.charAt(0))||n.skipToEnd()}}}var d={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};e.defineOption("highlightSelectionMatches",!1,function(i,o,l){if(l&&l!=e.Init&&(a(i),clearTimeout(i.state.matchHighlighter.timeout),i.state.matchHighlighter=null,i.off("cursorActivity",r),i.off("focus",n)),o){var c=i.state.matchHighlighter=new t(o);i.hasFocus()?(c.active=!0,s(i)):i.on("focus",n),i.on("cursorActivity",r)}})});